---
date: 2024-06-15
draft: false
title: Linear Programming
categories:
    - COMP90077
tags: 
    - algorithm
---


## Linear Program

最大流问题可以被表述为一个线性规划问题。线性规划是一种优化问题，目标是在一组线性约束条件下最大化或最小化一个线性目标函数。

对于最大流问题，我们可以定义以下的线性规划模型：

1. 变量：对于每条边 e，我们定义一个变量 f(e)，表示边 e 的流量。

2. 目标函数：我们的目标是最大化从源点 s 到汇点 t 的总流量，即最大化 ∑f(e)，其中求和是对所有从 s 出发的边 e 进行的。

3. 约束条件：我们有两种类型的约束条件：

   - 容量约束：对于每条边 e，我们有 f(e) ≤ c(e)，其中 c(e) 是边 e 的容量。
   
   - 流量守恒约束：对于图中的每个非源非汇节点 v，我们有 ∑f(e_in) = ∑f(e_out)，其中 e_in 是进入节点 v 的边，e_out 是离开节点 v 的边。

以下是对应的线性规划模型：

```
maximize ∑f(e) for all e from s
subject to
f(e) ≤ c(e) for all e
∑f(e_in) = ∑f(e_out) for all v ≠ s, t
f(e) ≥ 0 for all e
```

这个模型可以使用各种线性规划算法来解决，例如单纯形法（Simplex Method）或内点法（Interior Point Method）。

## Vertex Cover

顶点覆盖（Vertex Cover）是图论中的一个重要概念。

在一个图中，顶点覆盖是一个顶点的集合，这个集合的特性是图中的每一条边至少有一个端点在这个集合中。换句话说，如果你从这个集合中选出一个顶点，你可以覆盖到至少一条边。

例如，考虑一个简单的图，它有四个顶点（A, B, C, D）和四条边（AB, BC, CD, DA）。在这个图中，{A, B, C, D} 是一个顶点覆盖，因为每一条边都至少有一个端点在这个集合中。同样，{A, C} 或者 {B, D} 也是顶点覆盖。

顶点覆盖问题是寻找一个最小的顶点覆盖，也就是包含最少顶点的覆盖。这是一个 NP 完全问题，意味着没有已知的多项式时间算法可以解决所有的顶点覆盖问题。然而，有一些启发式算法和近似算法可以在实际中有效地解决顶点覆盖问题，例如贪心算法。

### Max Matching for Factor 2 Approximation

最大匹配（Max Matching）是图论中的一个重要概念。在一个图中，一个匹配是一个边的集合，其中每个顶点最多与一条边相连。最大匹配是一个具有最大边数的匹配。

一个简单的近似算法是找到一个最大匹配，然后将匹配中的每条边的两个端点都加入顶点覆盖。这个算法的解至多是最优解的两倍。

这个算法的正确性可以通过以下两点来证明：

1. 它是一个覆盖：假设不是，那么存在一条没有被覆盖的边。但是，这条边应该被加入到最大匹配中，因为它不与当前匹配中的任何边共享端点。这就产生了矛盾，所以这个假设是错误的，这个集合确实是一个覆盖。

2. 它至多是最优解的两倍：因为每条匹配的边都贡献了两个顶点到覆盖中，所以覆盖的大小是匹配的大小的两倍。而最大匹配的大小至少是任何顶点覆盖的大小（因为每个覆盖的顶点至多可以覆盖一条匹配的边），所以这个覆盖的大小至多是最优覆盖的大小的两倍。

### LP Relaxation for Vertex Cover
在线性规划版本的顶点覆盖问题中，我们的目标是找到一组𝑦𝑣的值（对应每个顶点𝑣），使得对于每条边(u,v)，都有𝑦𝑢 + 𝑦𝑣 ≥ 1，并且∑𝑦𝑣尽可能小。

当𝑦𝑣的值小于0.5时，这并不意味着会违反𝑦𝑢 + 𝑦𝑣 ≥ 1的条件。因为即使一个顶点的𝑦值小于0.5，只要它连接的另一个顶点的𝑦值大于0.5，那么这条边仍然可以被覆盖。换句话说，𝑦𝑢 + 𝑦𝑣 ≥ 1的条件是针对每条边来说的，而不是针对每个顶点。

所以，即使𝑦𝑣的值小于0.5，只要找到的这组𝑦𝑣的值满足对于每条边(u,v)，都有𝑦𝑢 + 𝑦𝑣 ≥ 1，那么就不会违反这个条件。
  
这是一个关于图论中顶点覆盖问题的线性规划近似解法的问题。这个方法的基本步骤如下：

1. 写出顶点覆盖问题的线性规划（LP）形式。
2. 在多项式时间内解决这个LP问题。
3. 在多项式时间内对LP解进行四舍五入，损失因子为2。

这个方法被称为2-近似解法，原因如下：

顶点覆盖问题的目标是找到一个最小的顶点集合，使得图中的每条边都至少与集合中的一个顶点相连。在LP解法中，每个顶点被赋予一个0到1之间的值，表示这个顶点被选中的可能性。然后，我们将这些值四舍五入到最近的整数，得到一个顶点覆盖的近似解。

这个方法的近似比例为2，是因为四舍五入操作可能会导致选中的顶点数目增加。具体来说，如果一个顶点在LP解中的值为0.5，那么在四舍五入后，这个顶点可能会被选中，从而增加了顶点覆盖的大小。然而，由于每个顶点的值都不会超过1，所以这个增加的数量最多不会超过原始LP解的两倍。因此，这个方法被称为2-近似解法。


## Set Cover

集合覆盖（Set Cover）是计算机科学中的一个经典问题，它是 NP 完全问题的一个例子。

给定一个有限集合 U 和 U 的若干子集 S1, S2, ..., Sn，集合覆盖问题是要找到最小的子集合的集合，使得这些子集合的并集等于 U。

例如，如果 U = {1, 2, 3, 4, 5}，S1 = {1, 2, 3}，S2 = {2, 4}，S3 = {3, 4, 5}，那么 {S1, S3} 就是一个集合覆盖，因为 S1 和 S3 的并集等于 U。

集合覆盖问题在许多实际问题中都有应用，例如在无线网络设计、数据库系统、信息检索等领域。在这些问题中，我们通常希望找到一个最小的集合覆盖，以最小化成本或资源使用。

集合覆盖问题是 NP 完全问题，这意味着没有已知的多项式时间算法可以解决所有的集合覆盖问题。然而，有一些启发式算法和近似算法可以在实际中有效地解决集合覆盖问题，例如贪心算法。

## LP Relaxation for Set Cover

这是关于集合覆盖问题的贪心算法近似解法的问题。集合覆盖问题是一个NP完全问题，其决策版本的目标是找到一个最小的子集合，使得这些子集合的并集等于全集。

贪心算法的基本步骤如下：

1. 初始化一个空的解决方案。
2. 在每一步，选择一个对当前解决方案贡献最大的集合，将其添加到解决方案中。这里的"贡献"是指该集合包含的、在当前解决方案中尚未被覆盖的元素数量（如果是加权版本，则还需要除以集合的权重）。
3. 重复第2步，直到全集被覆盖。

这个贪心算法的近似比例为1 + ln n，其中n是全集的元素数量。这是因为在每一步，我们总是选择贡献最大的集合，这保证了我们的解决方案不会比最优解差太多。具体来说，无论最优解需要多少个集合k，这个算法总是返回一个至多为k(1 + ln n)的解决方案。

更严格的分析表明，这个算法的近似因子实际上是(ln n - ln ln n) + Θ(1)。这意味着，随着n的增大，这个算法的性能会逐渐接近最优解。

然而，已经证明，除非P=NP，否则集合覆盖问题不能在1 - o(1) ⋅ ln n的范围内被近似。这意味着，我们不能期望有一个在多项式时间内运行的近似算法，其近似因子的增长速度比c ⋅ ln n慢，其中c < 1。

这是关于贪心算法在集合覆盖问题中的近似比例证明的问题。证明的基本思路如下：

1. 假设最优解包含k个集合。在每一次贪心迭代中，未被覆盖的元素数量会减少一个因子1 - 1/k。这是因为我们总是选择贡献最大的集合，而这个集合至少包含了最优解中每个集合的平均贡献。

2. 由于我们开始时有n个未被覆盖的元素，所以在进行k ln n次迭代后，所有的元素都会被覆盖。这里的ln n是因为在每次迭代中，未被覆盖的元素数量都会减少一个因子1 - 1/k，所以需要ln n次迭代才能将这个数量减少到1以下。

3. 由于实际的迭代次数可能不是整数，所以我们需要向上取整，得到⌈k ln n⌉。这意味着，我们的解决方案的大小最多为最优解的1 + ln n倍。

这个证明表明，贪心算法在集合覆盖问题中的近似比例为1 + ln n，这是一个对数级别的近似比例。这也解释了为什么这个算法被称为对数级别的贪心算法。

## Duality
线性规划的对偶性是一个非常重要的概念。对于每一个线性规划问题（称为原问题），都存在一个相关的线性规划问题（称为对偶问题）。原问题和对偶问题之间有一些非常有趣的关系。

1. 对偶问题的目标函数是原问题的约束条件的线性组合，反之亦然。

2. 对偶问题的解（对偶值）提供了原问题解（原值）的一个下界（如果是最大化问题）或上界（如果是最小化问题）。

3. 如果原问题和对偶问题都有解（即它们是可行的），那么它们的最优解是相等的。这就是所谓的弱对偶性。如果原问题是无界的，那么对偶问题是不可行的，反之亦然。

4. 在某些条件下（例如，如果原问题和对偶问题都满足某些正则性条件），我们可以保证强对偶性，即原问题的任何可行解和对偶问题的任何可行解都有相同的目标函数值。

这些对偶性质在解决线性规划问题时非常有用。例如，它们可以用来检验解的最优性，提供解的上下界，以及通过解对偶问题来更有效地解原问题。


## 近似算法

近似算法是一种在有限时间内找到最优解的近似解的算法。在许多情况下，找到最优解可能需要非常长的时间，或者甚至是不可能的。在这种情况下，近似算法可以提供一个可接受的、接近最优的解。近似算法的一个主要优点是它们通常可以在多项式时间内运行，这使得它们在处理大规模问题时非常有用。

## LPs 作为有效的松弛

在优化问题中，松弛是一种将一个难以解决的问题转化为一个更容易解决的问题的技术。线性规划可以作为一种有效的松弛技术，将一些难以直接解决的问题转化为线性规划问题。通过这种方式，我们可以利用线性规划的强大求解能力来解决更复杂的问题。


## 舍入、对偶拟合、原始-对偶方法

这些都是处理线性规划问题的技术。舍入是一种将连续解转化为离散解的方法；对偶拟合是一种通过解对偶问题来找到原问题解的方法；原始-对偶方法是一种同时解原问题和对偶问题的方法。这些技术都是为了在实际应用中更好地解决线性规划问题。